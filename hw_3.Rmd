---
title: "hw_3"
author: "Anna morgunova..."
output: html_document
---

```{r, message=FALSE}
library(tidyverse)
library(tidytext)
library(gutenbergr)
library(udpipe)
```

## Задание 3.1

В датасете, собранный [Adithya Ganesh](https://www.kaggle.com/adithyarganesh/english-premier-league-player-data-20182019#fpl_data_2018_2019.json), хранится информация об играках Английской Премьер-лиги. На основании этих данных (лежат в папке `data`) постройте график 30 игроков, которые забили больше всего голов и раскрасьте на основании их футбольного клуба.

![](task_1.png)
```{r}
fpl <- jsonlite::read_json(...)
...library(tidyverse)
library (ggplot2)
got_graf <- jsonlite::read_json("https://raw.githubusercontent.com/r-classes/2019_2020_ds4dh_hw3_purr_gutenbergr_tidytext_udpipe/master/data/fpl_data_2018_2019.json")
got_graf%>%
tibble(goli = map_chr(., "Goals"),
       clubi = map_chr(., "Club"))%>%
mutate(golichisla = as.integer(goli))%>%
within(rm(., goli))-> gotovie 
gotovie
got_graf%>%
map("name") %>% 
  enframe() %>%     
within(rm(value))-> gotovieimenaigrokov 
gotovie %>%
bind_cols(gotovieimenaigrokov)%>%
arrange(desc(golichisla))%>%
slice(1:30)%>%
ggplot(aes(fct_reorder(name, golichisla), golichisla,fill = clubi))+
geom_col()+
coord_flip()+
labs(x = "", y = "",title ="Numbers of goals",
     caption = "data from www.premierleague.com")
```

## Задание 3.2
Скачайте из проекта gutenberg.org текст "Женское международное движение: Сборник статей". Используя список русских стопслов (папка `data`, файл `stopwords_ru.csv`), уберите из текста служебные слова, посчитайте и визуализируйте 20 самых частостных слов текста.

![](task_2.png)

```{r}

```


## Задание 3.3

* Скачайте из проекта <gutenberg.org> текст "Красавице, которая нюхала табак",
* используйте команду `str_c(text_5316$text, collapse = " ")`, чтобы объединить все строки, на которые поделено произведение в одну строку, 
* запустите на получившемся векторе анализатор `russian-syntagrus-ud-2.4-190531.udpipe`, 
* в получившемся датафрейме замените все пометы `DET` в столбце с частями речи (переменная `upos`) на `PART`, а у двух слов с пометой `AUX` поменяйте помету на `PART` (слово *б*) и на `VERB` (слово *быть*),
* посчитайте каждой из частей речи (переменная `upos`), 
* и постройте график:

![](task_3.png)

```{r}

```

